<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>CTR PREDICTOR</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/skel-layers.min.js"></script>
		<script src="js/init.js"></script>
		<script src="js/d3.v3.min.js" charset="utf-8"></script>
		<link rel="stylesheet" href="css/custom.css" />
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-xlarge.css" />
		</noscript>
		<style>
			.chart div {
				font: 10px sans-serif;
				background-color: steelblue;
				text-align: right;
				padding: 3px;
				margin: 1px;
				color: white;
			}
			.axis path {
				fill: none;
				stroke: #777;
				shape-rendering: crispEdges;
			}
			.axis text {
				font-family: Lato;
				font-size: 13px;
			}
		</style>
	</head>
	<body class="landing">



		<!-- One -->
			<section id="one" class="wrapper style1 special">
				<div class="container">
					<header class="major">
						<h2>Results</h2>
						<p>These are some results we've got</p>
					</header>
					<!--
					<div class="row 150%">
						<div class="4u 12u$(medium)">
							<section class="box">
								<h3>Hotel category (stars)</h3>
								<div id="stars_chart" class="chart"></div>
							</section>
						</div>
						<div class="4u 12u$(medium)">
							<section class="box">
								<i class="icon big rounded color9 fa-desktop"></i>
								<h3>Consectetur adipisicing</h3>
								<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Laudantium ullam consequatur repellat debitis maxime.</p>
							</section>
						</div>
						<div class="4u$ 12u$(medium)">
							<section class="box">
								<i class="icon big rounded color6 fa-rocket"></i>
								<h3>Adipisicing elit totam</h3>
								<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Atque eaque eveniet, nesciunt molestias. Ipsam, voluptate vero.</p>
							</section>
						</div>
					</div>
					-->
				</div>
			</section>
			<section id="two" class="wrapper style2 special">
				<div class="container">
					<div class="row 150%">
						<div class="12u 12u$(medium)">
							<section class="box">
								<h3>Income per CTR Threshold</h3>
								<svg id="visualisation" width="1000" height="500"></svg>
								<p style="color:black;">CTR Threshold (%)</p>
							</section>
						</div>
					</div>
					<div class="row 150%">
						<div class="12u 12u$(medium)">
							<section class="box">
								<h3>ROC</h3>
								<img src="images/ROC_weighted_log_loss_def.jpg" alt="ROC_img"></img>
							</section>
						</div>
					</div>
				</div>
			</section>

		<!-- Two 
			<section id="two" class="wrapper style2 special">
				<div class="container">
					<header class="major">
						<h2>The Team</h2>
						<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, autem.</p>
					</header>
					<section class="profiles">
						<div class="row">
							<section class="3u 6u(medium) 12u$(xsmall) profile">
								<img src="images/profile_placeholder.gif" alt="" />
								<h4>Alex Castrelo</h4>
								<p>Computer Engineer</p>
							</section>
							<section class="3u 6u$(medium) 12u$(xsmall) profile">
								<img src="images/profile_placeholder.gif" alt="" />
								<h4>Cristina serrano</h4>
								<p>Industrial Engineer</p>
							</section>
							<section class="3u 6u(medium) 12u$(xsmall) profile">
								<img src="images/profile_placeholder.gif" alt="" />
								<h4>Laura Riba</h4>
								<p>Statistic</p>
							</section>
							<section class="3u$ 6u$(medium) 12u$(xsmall) profile">
								<img src="images/profile_placeholder.gif" alt="" />
								<h4>Luis Blanco</h4>
								<p>Telecom Engineer</p>
							</section>
							<section class="3u$ 6u$(medium) 12u$(xsmall) profile">
								<img src="images/profile_placeholder.gif" alt="" />
								<h4>Xavier Paredes</h4>
								<p>Physicist</p>
							</section>
						</div>
					</section>
					<footer>
						<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quibusdam dolore illum, temporibus veritatis eligendi, aliquam, dolor enim itaque veniam aut eaque sequi qui quia vitae pariatur repudiandae ab dignissimos ex!</p>
						<ul class="actions">
							<li>
								<a href="#" class="button big">Lorem ipsum dolor sit</a>
							</li>
						</ul>
					</footer>
				</div>
			</section>-->

		<!-- Three -->
			<!--<section id="three" class="wrapper style3 special">
				<div class="container">
					<header class="major">
						<h2>Get in touch with us</h2>
						<p>Lorem ipsum dolor sit amet. Delectus consequatur, similique quia!</p>
					</header>
				</div>
				<div class="container 50%">
					<form action="#" method="post">
						<div class="row uniform">
							<div class="6u 12u$(small)">
								<input name="name" id="name" value="" placeholder="Name" type="text">
							</div>
							<div class="6u$ 12u$(small)">
								<input name="email" id="email" value="" placeholder="Email" type="email">
							</div>
							<div class="12u$">
								<textarea name="message" id="message" placeholder="Message" rows="6"></textarea>
							</div>
							<div class="12u$">
								<ul class="actions">
									<li><input value="Send Message" class="special big" type="submit"></li>
								</ul>
							</div>
						</div>
					</form>
				</div>
			</section>-->

		<!-- Footer -->
			<footer id="footer">
				<div class="container">
					<div class="row">
						<div class="8u 12u$(medium)">
							<ul class="copyright">
								<li>&copy; <a href="http://www.wtfpl.net/txt/copying/" target="_blank">DWTFYW Public License</a></li>
								<li>Design: <a href="http://templated.co" target="_blank">TEMPLATED</a></li>
								<li>Images: <a href="http://unsplash.com" target="_blank">Unsplash</a></li>
							</ul>
						</div>
						<div class="4u$ 12u$(medium)">
							<ul class="icons">
								<li>
									<a class="icon rounded fa-facebook"><span class="label">Facebook</span></a>
								</li>
								<li>
									<a class="icon rounded fa-twitter"><span class="label">Twitter</span></a>
								</li>
								<li>
									<a class="icon rounded fa-google-plus"><span class="label">Google+</span></a>
								</li>
								<li>
									<a class="icon rounded fa-linkedin"><span class="label">LinkedIn</span></a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</footer>

	</body>
	<script>
		var res,range;
		
		$.ajax({
			//url: "data/thresholdVSrevenue.txt",
			//url: "data/thresholdVSrevenue_v2.txt",
			url: "data/thresholdVSrevenue_v3.txt",
			error: function(e,text,errorThrown){
				console.log("Error")
				console.log(text);
				console.log(e);
				console.log(errorThrown);
			},
			success: function(data){
				$.ajax({
					url: "data/baseline.txt",
					error: function(){
						console.log("Error");
						console.log(text);
						console.log(e);
						console.log(errorThrown);
					},
					success: function(data2){
						$.ajax({
							url: "data/thresholdVSrevenue.txt",
							error: function(){
								console.log("Error");
								console.log(text);
								console.log(e);
								console.log(errorThrown);
							},
							success: function(data3){
								console.log("SUCCESS");
								data = data.split("\n").map(function(e){return {"x":e.split(" ")[0], "y":e.split(" ")[1]}});
								range = getRangeXY(data);
								data2 = data2.split("\n").map(function(e){return {"x":e.split(" ")[0], "y":e.split(" ")[1]}});
								data3 = data3.split("\n").map(function(e){return {"x":e.split(" ")[0], "y":e.split(" ")[1]}});
								var vis = d3.select("#visualisation");
								var WIDTH = 1000;
								var HEIGHT = 500;
								var MARGINS = {
									top: 20,
									right: 20,
									bottom: 20,
									left: 50
								};
								var xScale = d3.scale.linear().range([MARGINS.left, WIDTH - MARGINS.right]).domain([range.minX, range.maxX]);
								var yScale = d3.scale.linear().range([HEIGHT - MARGINS.top, MARGINS.bottom]).domain([range.minY, range.maxY]);
								
								var xAxis = d3.svg.axis()
									.scale(xScale);

								var yAxis = d3.svg.axis()
									.scale(yScale)
									.orient("left");
									
								vis.append("svg:g")
									.attr("class","axis")
									.attr("transform", "translate(0," + (HEIGHT - MARGINS.bottom) + ")")
									.call(xAxis);
								/*	
								vis.append("text")      // text label for the x axis
									.attr("x", WIDTH / 2 )
									.attr("y",  HEIGHT )
									.style("text-anchor", "middle")
									.text("X");
								*/	
								vis.append("svg:g")
									.attr("class","axis")
									.attr("transform", "translate(" + (MARGINS.left) + ",0)")
									.call(yAxis);
								
								vis.append("text")
									.attr("transform", "rotate(-90)")
									.attr("y", 0)
									.attr("x", 0 - (HEIGHT / 2))
									.attr("dy", "1em")
									.style("text-anchor", "middle")
									.text("Income (â‚¬)");	
								
								var lineGen = d3.svg.line()
									.x(function(d) {
										return xScale(d.x);
									})
									.y(function(d) {
										return yScale(d.y);
									})
									.interpolate("basis");
								
								vis.append('svg:path')
								  .attr('d', lineGen(data))
								  .attr('stroke', 'green')
								  .attr('stroke-width', 2)
								  .attr('fill', 'none');
								  
								vis.append('svg:path')
								  .attr('d', lineGen(data2))
								  .attr('stroke', 'blue')
								  .attr('stroke-width', 2)
								  .attr('fill', 'none');
								
								vis.append('svg:path')
								  .attr('d', lineGen(data3))
								  .attr('stroke', 'red')
								  .attr('stroke-width', 2)
								  .attr('fill', 'none');
							}
						})
					}
				})
			}
		})
		
		function getRangeXY(data){
			var maxX = maxY = Number.NEGATIVE_INFINITY;
			var minX = minY = Number.POSITIVE_INFINITY;
			data.forEach(function(e){
				minX = (e.x < minX)? Math.floor(e.x):minX;
				minY = (e.y < minY)? Math.floor(e.y):minY;
				maxX = (e.x > maxX)? Math.ceil(e.x):maxX;
				maxY = (e.y > maxY)? Math.ceil(e.y):maxY;
			});
			return {"minX":minX, "minY":minY, "maxX":maxX, "maxY":maxY}
		}
		
		
	</script>
	
</html>